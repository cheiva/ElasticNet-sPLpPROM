# 基于代谢组学的早产预测模型构建

## 重要声明

**本仓库仅包含项目代码与模拟数据。原始代谢组学数据受版权保护，严禁外传，已按项目要求进行替换。**

## 概述

本项目基于孕妇代谢组学数据，利用弹性网络（Elastic Net）算法构建了一个多分类模型，用于区分正常妊娠（normal）、自发性早产（sPL）和胎膜早破（pPROM）。针对高维小样本的数据特点，我们通过严格的预处理、特征筛选和参数优化，在测试集上取得了 **84.38%** 的整体准确率（95% CI: 67.21%-94.72%），Kappa系数为 **0.7664**。并对关键代谢标志物的重要性进行排列，为早产亚型的早期预测提供了新的生物标志物组合。

与随机森林（Random Forest）等模型相比，弹性网络在本场景下表现出显著优势，是处理此类数据更为有效的解决方案。

## 目录结构

```
sPL-pPROM/
├── data/              # 数据目录（已替换为模拟数据）
│   ├── raw/          # 原始数据（模拟）
│   └── processed/    # 预处理后的数据
├── scripts/              # 源代码
│   └── ElasticNet.R  # 主分析脚本（包含预处理、建模、评估）
└── results/          # 输出结果
    ├── figures/      # 生成图表（如热力图、ROC曲线、特征重要性图）
    └── models/       # 训练好的模型文件
```

## 分析流程

### 1. 数据预处理

- **数据整合与标注**：合并代谢组学数据与临床分组信息。
- **标准化**：使用训练集参数（均值、方差）对训练集和测试集进行Z-score标准化，以消除量纲差异。
- **特征预筛选**：应用方差过滤法，剔除低方差代谢物特征，降低维度。

### 2. 模型构建与训练

- **算法选择**：采用适用于高维数据的弹性网络回归（Elastic Net）。
- **参数优化**：设置了扩展的正则化参数（lambda）网格进行搜索。
- **训练方法**：使用5折交叉验证重复5次，以稳健评估模型性能并减轻过拟合。

### 3. 模型评估与解释

- **性能评估**：在预留的测试集上计算准确率、Kappa系数及置信区间，并绘制混淆矩阵（热力图）和ROC曲线。
- **特征提取**：从模型中提取重要性排名前19的特征（代谢物），并可视化其贡献度。

## 小结

- **成功要素**：本项目成功处理了高维小样本数据的挑战。实践证明，弹性网络在此类问题上的性能显著优于随机森林等传统机器学习模型。
- **局限性**：当前准确率对于临床直接应用仍有一定距离。模型性能的进一步提升可能依赖于扩大样本量或引入更复杂的特征工程与集成策略。

------

